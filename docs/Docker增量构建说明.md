# Dockerå¢é‡æ„å»ºè¯´æ˜

## âœ… å·²ä¼˜åŒ–ä¸ºå¢é‡æ„å»º

### 1. åç«¯Dockerfileä¼˜åŒ–

**ä¼˜åŒ–ç­–ç•¥**ï¼š
- å°†ä¾èµ–å®‰è£…å’Œä»£ç å¤åˆ¶åˆ†ç¦»
- ä¾èµ–æ–‡ä»¶ï¼ˆrequirements.txtï¼‰å•ç‹¬ä¸€å±‚
- åº”ç”¨ä»£ç æ”¾åœ¨æœ€å

**æ„å»ºé¡ºåº**ï¼š
1. ç³»ç»Ÿé…ç½®ï¼ˆå¾ˆå°‘å˜åŒ–ï¼‰â†’ ç¼“å­˜
2. ç³»ç»Ÿä¾èµ–å®‰è£…ï¼ˆå¾ˆå°‘å˜åŒ–ï¼‰â†’ ç¼“å­˜
3. å¤åˆ¶requirements.txt â†’ åªæœ‰ä¾èµ–å˜åŒ–æ—¶æ‰é‡å»º
4. å®‰è£…Pythonä¾èµ– â†’ åªæœ‰requirements.txtå˜åŒ–æ—¶æ‰é‡å»º
5. å¤åˆ¶åº”ç”¨ä»£ç  â†’ ä»£ç å˜åŒ–æ—¶åªé‡å»ºè¿™ä¸€å±‚

**æ•ˆæœ**ï¼š
- âœ… ä¿®æ”¹ä»£ç æ—¶ï¼Œä¸ä¼šé‡æ–°å®‰è£…ä¾èµ–
- âœ… åªæœ‰requirements.txtå˜åŒ–æ—¶ï¼Œæ‰é‡æ–°å®‰è£…ä¾èµ–
- âœ… å¤§å¹…å‡å°‘æ„å»ºæ—¶é—´

### 2. å‰ç«¯Dockerfileä¼˜åŒ–

**ä¼˜åŒ–ç­–ç•¥**ï¼š
- package.jsonå•ç‹¬ä¸€å±‚
- ä¾èµ–å®‰è£…å’Œä»£ç å¤åˆ¶åˆ†ç¦»

**æ„å»ºé¡ºåº**ï¼š
1. å¤åˆ¶package.jsonå’Œpackage-lock.json
2. å®‰è£…npmä¾èµ–ï¼ˆåªæœ‰packageæ–‡ä»¶å˜åŒ–æ—¶æ‰é‡å»ºï¼‰
3. å¤åˆ¶åº”ç”¨ä»£ç ï¼ˆä»£ç å˜åŒ–æ—¶åªé‡å»ºè¿™ä¸€å±‚ï¼‰

**æ•ˆæœ**ï¼š
- âœ… ä¿®æ”¹ä»£ç æ—¶ï¼Œä¸ä¼šé‡æ–°å®‰è£…node_modules
- âœ… åªæœ‰package.jsonå˜åŒ–æ—¶ï¼Œæ‰é‡æ–°å®‰è£…ä¾èµ–
- âœ… å¤§å¹…å‡å°‘æ„å»ºæ—¶é—´

### 3. docker-compose.ymlé…ç½®

**å·²é…ç½®volumesæŒ‚è½½**ï¼š
```yaml
backend:
  volumes:
    - ./backend:/app  # ä»£ç å®æ—¶åŒæ­¥
frontend:
  volumes:
    - ./frontend:/app  # ä»£ç å®æ—¶åŒæ­¥
    - /app/node_modules  # node_modulesä¸æŒ‚è½½ï¼ˆä½¿ç”¨å®¹å™¨å†…çš„ï¼‰
    - /app/.next  # .nextä¸æŒ‚è½½ï¼ˆä½¿ç”¨å®¹å™¨å†…çš„ï¼‰
```

**æ•ˆæœ**ï¼š
- âœ… ä¿®æ”¹ä»£ç åï¼Œå®¹å™¨å†…ç«‹å³ç”Ÿæ•ˆï¼ˆæ— éœ€é‡å»ºï¼‰
- âœ… åç«¯ä½¿ç”¨`--reload`ï¼Œè‡ªåŠ¨é‡è½½
- âœ… å‰ç«¯ä½¿ç”¨`npm run dev`ï¼Œæ”¯æŒçƒ­é‡è½½

## ğŸš€ ä½¿ç”¨æ–¹å¼

### å¼€å‘æ¨¡å¼ï¼ˆæ¨èï¼‰

```bash
# é¦–æ¬¡æ„å»º
docker compose build

# å¯åŠ¨æœåŠ¡ï¼ˆä»£ç ä¿®æ”¹åè‡ªåŠ¨ç”Ÿæ•ˆï¼Œæ— éœ€é‡å»ºï¼‰
docker compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker compose logs -f
```

### ä¿®æ”¹ä»£ç å

**æ— éœ€ä»»ä½•æ“ä½œ**ï¼š
- åç«¯ï¼šä»£ç ä¿®æ”¹åï¼Œuvicornè‡ªåŠ¨é‡è½½ï¼ˆ--reloadï¼‰
- å‰ç«¯ï¼šä»£ç ä¿®æ”¹åï¼ŒNext.jsè‡ªåŠ¨çƒ­é‡è½½

### åªæœ‰ä»¥ä¸‹æƒ…å†µéœ€è¦é‡å»º

1. **ä¿®æ”¹äº†ä¾èµ–æ–‡ä»¶**ï¼š
   ```bash
   # ä¿®æ”¹äº†requirements.txtæˆ–package.json
   docker compose build
   ```

2. **ä¿®æ”¹äº†Dockerfile**ï¼š
   ```bash
   docker compose build --no-cache
   ```

## ğŸ“Š æ„å»ºæ—¶é—´å¯¹æ¯”

### ä¼˜åŒ–å‰
- æ¯æ¬¡ä¿®æ”¹ä»£ç ï¼š~5-10åˆ†é’Ÿï¼ˆé‡æ–°å®‰è£…æ‰€æœ‰ä¾èµ–ï¼‰

### ä¼˜åŒ–å
- ä¿®æ”¹ä»£ç ï¼š0ç§’ï¼ˆæ— éœ€é‡å»ºï¼Œvolumeså®æ—¶åŒæ­¥ï¼‰
- ä¿®æ”¹ä¾èµ–ï¼š~2-3åˆ†é’Ÿï¼ˆåªé‡æ–°å®‰è£…ä¾èµ–å±‚ï¼‰
- é¦–æ¬¡æ„å»ºï¼š~5-10åˆ†é’Ÿï¼ˆæ­£å¸¸ï¼‰

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **volumesæŒ‚è½½**ï¼š
   - å¼€å‘ç¯å¢ƒï¼šä½¿ç”¨volumesæŒ‚è½½ï¼Œä»£ç å®æ—¶åŒæ­¥
   - ç”Ÿäº§ç¯å¢ƒï¼šä¸ä½¿ç”¨volumesï¼Œä½¿ç”¨æ„å»ºçš„é•œåƒ

2. **node_modules**ï¼š
   - ä½¿ç”¨åŒ¿åå·`/app/node_modules`ï¼Œé¿å…è¦†ç›–å®¹å™¨å†…çš„ä¾èµ–

3. **.nextç›®å½•**ï¼š
   - ä½¿ç”¨åŒ¿åå·`/app/.next`ï¼Œé¿å…è¦†ç›–æ„å»ºç¼“å­˜

## ğŸ”§ éªŒè¯å¢é‡æ„å»º

```bash
# 1. é¦–æ¬¡æ„å»ºï¼ˆè®°å½•æ—¶é—´ï¼‰
time docker compose build

# 2. ä¿®æ”¹ä»£ç ï¼ˆä¸ä¿®æ”¹ä¾èµ–ï¼‰
echo "// test" >> frontend/app/page.tsx

# 3. å†æ¬¡æ„å»ºï¼ˆåº”è¯¥å¾ˆå¿«ï¼Œåªé‡å»ºä»£ç å±‚ï¼‰
time docker compose build

# 4. ä¿®æ”¹ä¾èµ–
echo "new-package==1.0.0" >> backend/requirements.txt

# 5. å†æ¬¡æ„å»ºï¼ˆä¼šé‡æ–°å®‰è£…ä¾èµ–ï¼‰
time docker compose build
```

## âœ… æ€»ç»“

- âœ… Dockerfileå·²ä¼˜åŒ–ä¸ºå¢é‡æ„å»º
- âœ… docker-compose.ymlå·²é…ç½®volumeså®æ—¶åŒæ­¥
- âœ… å¼€å‘æ—¶ä¿®æ”¹ä»£ç æ— éœ€é‡å»º
- âœ… åªæœ‰ä¾èµ–å˜åŒ–æ—¶æ‰éœ€è¦é‡å»º

