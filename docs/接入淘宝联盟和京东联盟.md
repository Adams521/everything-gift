# æ¥å…¥æ·˜å®è”ç›Ÿå’Œäº¬ä¸œè”ç›ŸæŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æ¥å…¥æ·˜å®è”ç›Ÿå’Œäº¬ä¸œè”ç›Ÿå¯ä»¥è·å–çœŸå®çš„å•†å“æ•°æ®ï¼ŒåŒ…æ‹¬ï¼š
- âœ… çœŸå®å•†å“å›¾ç‰‡
- âœ… å‡†ç¡®çš„ä»·æ ¼ä¿¡æ¯
- âœ… å•†å“è¯¦æƒ…å’Œæè¿°
- âœ… ä¼˜æƒ åˆ¸ä¿¡æ¯
- âœ… é”€é‡æ•°æ®
- âœ… ä½£é‡‘ä¿¡æ¯

## ğŸ”‘ ä¸€ã€æ·˜å®è”ç›Ÿæ¥å…¥

### 1. æ³¨å†Œå’Œç”³è¯·

1. **è®¿é—®é˜¿é‡Œå¦ˆå¦ˆ**ï¼šhttps://www.alimama.com/
2. **ç™»å½•/æ³¨å†Œ**ï¼šä½¿ç”¨æ·˜å®è´¦å·ç™»å½•
3. **åª’ä½“å¤‡æ¡ˆ**ï¼š
   - è¿›å…¥"åª’ä½“å¤‡æ¡ˆç®¡ç†"
   - æ·»åŠ æ‚¨çš„ç½‘ç«™ä¿¡æ¯
   - ç­‰å¾…å®¡æ ¸é€šè¿‡ï¼ˆé€šå¸¸1-3ä¸ªå·¥ä½œæ—¥ï¼‰

4. **ç”³è¯·APIæƒé™**ï¼š
   - å®¡æ ¸é€šè¿‡åï¼Œåœ¨ç½‘ç«™åˆ—è¡¨ä¸­ç‚¹å‡»"APPKEYç”³è¯·"
   - å¡«å†™ç”³è¯·ç†ç”±ï¼ˆä¸å°‘äº100å­—ï¼‰
   - å‹¾é€‰éœ€è¦çš„APIæƒé™ï¼š
     - `taobao.tbk.dg.material.optional` - å•†å“æœç´¢
     - `taobao.tbk.item.info.get` - å•†å“è¯¦æƒ…
   - ç­‰å¾…å®¡æ ¸é€šè¿‡

5. **è·å–å‡­è¯**ï¼š
   - App Key
   - App Secret
   - PIDï¼ˆæ¨å¹¿ä½ï¼Œæ ¼å¼ï¼šmm_xxx_xxx_xxxï¼‰

### 2. é…ç½®ç¯å¢ƒå˜é‡

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºæˆ–ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```bash
# æ·˜å®è”ç›Ÿé…ç½®
TAOBAO_UNION_APP_KEY=your_app_key
TAOBAO_UNION_APP_SECRET=your_app_secret
TAOBAO_UNION_PID=mm_xxx_xxx_xxx
```

### 3. ä½¿ç”¨ä»£ç 

ä»£ç å·²å®ç°ï¼Œä½ç½®ï¼š`backend/app/services/taobao_union.py`

```python
from app.services.taobao_union import TaobaoUnionAPI

api = TaobaoUnionAPI()
products = await api.search_products("ç”Ÿæ—¥ç¤¼ç‰©", page_no=1, page_size=20)
```

## ğŸ”‘ äºŒã€äº¬ä¸œè”ç›Ÿæ¥å…¥

### 1. æ³¨å†Œå’Œç”³è¯·

1. **è®¿é—®äº¬ä¸œè”ç›Ÿ**ï¼šhttps://union.jd.com/
2. **ç™»å½•/æ³¨å†Œ**ï¼šä½¿ç”¨äº¬ä¸œè´¦å·ç™»å½•
3. **ç½‘ç«™å¤‡æ¡ˆ**ï¼š
   - è¿›å…¥"æ¨å¹¿ç®¡ç†" -> "ç½‘ç«™ç®¡ç†"
   - æ·»åŠ ç½‘ç«™ä¿¡æ¯
   - å®ŒæˆéªŒè¯å¹¶ç­‰å¾…å®¡æ ¸

4. **ç”³è¯·APIæƒé™**ï¼š
   - å®¡æ ¸é€šè¿‡åï¼Œç”³è¯·APIæƒé™
   - è·å– App Key å’Œ App Secret
   - è·å– Site ID

### 2. é…ç½®ç¯å¢ƒå˜é‡

åœ¨ `.env` æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```bash
# äº¬ä¸œè”ç›Ÿé…ç½®
JD_UNION_APP_KEY=your_app_key
JD_UNION_APP_SECRET=your_app_secret
JD_UNION_SITE_ID=your_site_id
```

### 3. ä½¿ç”¨ä»£ç 

ä»£ç å·²å®ç°ï¼Œä½ç½®ï¼š`backend/app/services/jd_union.py`

```python
from app.services.jd_union import JDUnionAPI

api = JDUnionAPI()
products = await api.search_products("ç”Ÿæ—¥ç¤¼ç‰©", page_index=1, page_size=20)
```

## ğŸš€ ä¸‰ã€ä½¿ç”¨è”ç›Ÿçˆ¬è™«

### è¿è¡Œè”ç›Ÿçˆ¬è™«

```bash
# è¿›å…¥åç«¯å®¹å™¨
docker compose exec backend bash

# è¿è¡Œè”ç›Ÿçˆ¬è™«
python -c "
import sys
sys.path.insert(0, '/app')
from app.crawlers.union_crawler import UnionCrawler
import asyncio

async def run():
    crawler = UnionCrawler()
    keywords = ['ç”Ÿæ—¥ç¤¼ç‰©', 'æƒ…äººèŠ‚ç¤¼ç‰©', 'æ¯äº²èŠ‚ç¤¼ç‰©']
    products = await crawler.crawl_products(keywords)
    print(f'çˆ¬å–äº† {len(products)} ä¸ªå•†å“')

asyncio.run(run())
"
```

### è‡ªåŠ¨ä½¿ç”¨è”ç›ŸAPI

å¦‚æœé…ç½®äº†è”ç›ŸAPIå¯†é’¥ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨è”ç›ŸAPIè·å–å•†å“æ•°æ®ã€‚

## ğŸ–¼ï¸ å››ã€è§£å†³å›¾ç‰‡æ˜¾ç¤ºé—®é¢˜

### é—®é¢˜åŸå› 

1. å½“å‰æ•°æ®ä½¿ç”¨å ä½å›¾ï¼ˆplaceholderï¼‰
2. å›¾ç‰‡URLå¯èƒ½æ— æ•ˆ
3. éœ€è¦çœŸå®å•†å“å›¾ç‰‡

### è§£å†³æ–¹æ¡ˆ

#### æ–¹æ¡ˆ1ï¼šä½¿ç”¨è”ç›ŸAPIï¼ˆæ¨èï¼‰âœ…

é…ç½®è”ç›ŸAPIåï¼Œä¼šè‡ªåŠ¨è·å–çœŸå®å•†å“å›¾ç‰‡ï¼š

```bash
# é…ç½®ç¯å¢ƒå˜é‡
TAOBAO_UNION_APP_KEY=your_key
TAOBAO_UNION_APP_SECRET=your_secret
TAOBAO_UNION_PID=your_pid

# é‡å¯åç«¯
docker compose restart backend

# è¿è¡Œçˆ¬è™«æ›´æ–°æ•°æ®
docker compose exec backend python -c "
import sys
sys.path.insert(0, '/app')
from app.crawlers.save_products import save_crawled_products
import asyncio
asyncio.run(save_crawled_products())
"
```

#### æ–¹æ¡ˆ2ï¼šæ›´æ–°ç°æœ‰æ•°æ®å›¾ç‰‡

```bash
# æ›´æ–°æ•°æ®åº“ä¸­çš„å•†å“å›¾ç‰‡
docker compose exec backend python -c "
import sys
sys.path.insert(0, '/app')
from app.core.database import SessionLocal
from app.models import Product
import random

db = SessionLocal()
products = db.query(Product).all()

# ä½¿ç”¨UnsplashçœŸå®å›¾ç‰‡
image_urls = [
    'https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=400&h=400&fit=crop',
    'https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=400&h=400&fit=crop',
    'https://images.unsplash.com/photo-1441986300917-64674bd600d8?w=400&h=400&fit=crop',
    'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=400&h=400&fit=crop',
    'https://images.unsplash.com/photo-1556910103-1c02745aae4d?w=400&h=400&fit=crop',
]

for i, p in enumerate(products):
    if not p.image_url or 'placeholder' in p.image_url:
        p.image_url = image_urls[i % len(image_urls)]
        db.add(p)

db.commit()
print(f'âœ… æ›´æ–°äº† {len(products)} ä¸ªå•†å“çš„å›¾ç‰‡')
db.close()
"
```

## ğŸ“ äº”ã€APIæ–‡æ¡£

### æ·˜å®è”ç›Ÿä¸»è¦API

1. **å•†å“æœç´¢**ï¼š`taobao.tbk.dg.material.optional`
   - åŠŸèƒ½ï¼šæ ¹æ®å…³é”®è¯æœç´¢å•†å“
   - è¿”å›ï¼šå•†å“åˆ—è¡¨ï¼ˆåŒ…å«å›¾ç‰‡ã€ä»·æ ¼ã€é“¾æ¥ç­‰ï¼‰

2. **å•†å“è¯¦æƒ…**ï¼š`taobao.tbk.item.info.get`
   - åŠŸèƒ½ï¼šè·å–å•†å“è¯¦ç»†ä¿¡æ¯
   - è¿”å›ï¼šå•†å“è¯¦æƒ…æ•°æ®

### äº¬ä¸œè”ç›Ÿä¸»è¦API

1. **å•†å“æœç´¢**ï¼š`jd.union.open.goods.query`
   - åŠŸèƒ½ï¼šæœç´¢å•†å“
   - è¿”å›ï¼šå•†å“åˆ—è¡¨

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **APIé™åˆ¶**ï¼š
   - æ·˜å®è”ç›Ÿï¼šæœ‰è°ƒç”¨é¢‘ç‡é™åˆ¶
   - äº¬ä¸œè”ç›Ÿï¼šéœ€è¦å…ˆè·å–access_token

2. **æ•°æ®æ›´æ–°**ï¼š
   - å»ºè®®å®šæœŸæ›´æ–°å•†å“æ•°æ®
   - ä»·æ ¼å’Œåº“å­˜å¯èƒ½å˜åŒ–

3. **åˆè§„ä½¿ç”¨**ï¼š
   - éµå®ˆè”ç›Ÿä½¿ç”¨è§„èŒƒ
   - ä¸å¾—ç”¨äºè¿è§„ç”¨é€”
   - éœ€è¦æ˜¾ç¤ºæ¨å¹¿æ ‡è¯†

4. **ä½£é‡‘ç»“ç®—**ï¼š
   - ç”¨æˆ·é€šè¿‡æ‚¨çš„é“¾æ¥è´­ä¹°ï¼Œæ‚¨ä¼šè·å¾—ä½£é‡‘
   - éœ€è¦ç»‘å®šæ”¯ä»˜å®/é“¶è¡Œå¡

## ğŸ”§ å…­ã€æµ‹è¯•é…ç½®

### æµ‹è¯•æ·˜å®è”ç›ŸAPI

```bash
docker compose exec backend python -c "
import sys
sys.path.insert(0, '/app')
from app.services.taobao_union import TaobaoUnionAPI
import asyncio

async def test():
    api = TaobaoUnionAPI()
    products = await api.search_products('ç”Ÿæ—¥ç¤¼ç‰©', page_size=3)
    print(f'è·å–åˆ° {len(products)} ä¸ªå•†å“')
    for p in products[:2]:
        print(f'  - {p[\"name\"]}')
        print(f'    å›¾ç‰‡: {p.get(\"image_url\", \"æ— \")[:50]}')

asyncio.run(test())
"
```

### æµ‹è¯•äº¬ä¸œè”ç›ŸAPI

```bash
docker compose exec backend python -c "
import sys
sys.path.insert(0, '/app')
from app.services.jd_union import JDUnionAPI
import asyncio

async def test():
    api = JDUnionAPI()
    products = await api.search_products('ç”Ÿæ—¥ç¤¼ç‰©', page_size=3)
    print(f'è·å–åˆ° {len(products)} ä¸ªå•†å“')
    for p in products[:2]:
        print(f'  - {p[\"name\"]}')

asyncio.run(test())
"
```

## ğŸ“š å‚è€ƒé“¾æ¥

- æ·˜å®è”ç›Ÿï¼šhttps://www.alimama.com/
- äº¬ä¸œè”ç›Ÿï¼šhttps://union.jd.com/
- æ·˜å®å¼€æ”¾å¹³å°ï¼šhttps://open.taobao.com/
- äº¬ä¸œå¼€æ”¾å¹³å°ï¼šhttps://open.jd.com/

## âœ… å®Œæˆåçš„æ•ˆæœ

é…ç½®è”ç›ŸAPIåï¼š
- âœ… å•†å“å›¾ç‰‡æ˜¾ç¤ºæ­£å¸¸ï¼ˆçœŸå®å•†å“å›¾ï¼‰
- âœ… ä»·æ ¼ä¿¡æ¯å‡†ç¡®
- âœ… å•†å“é“¾æ¥æœ‰æ•ˆ
- âœ… å¯ä»¥è·å¾—ä½£é‡‘æ”¶ç›Š
